trigger:
- main   # rama que dispara el pipeline

pool:
  vmImage: 'ubuntu-latest'   # ðŸ‘ˆ usa agentes hospedados de Azure

steps:
  # 1. Instalar Node.js
  - task: NodeTool@0
    inputs:
      versionSpec: '18.x'
    displayName: 'Instalar Node.js'

  # 2. Instalar dependencias y compilar
  - script: |
      npm install
      npm run build
    displayName: 'Compilar aplicaciÃ³n React (Vite)'

  # 3. Subir archivos a S3
  - task: AWSShellScript@1
    inputs:
      awsCredentials: 'AWS connection'   # ðŸ‘ˆ nombre exacto de tu Service Connection en Azure
      regionName: 'us-east-1'            # ðŸ‘ˆ cambia si tu bucket estÃ¡ en otra regiÃ³n
      scriptType: 'inline'
      inlineScript: |
        aws s3 sync dist/ s3://rohi-ips-dev/ --delete
    displayName: 'Deploy a S3'
